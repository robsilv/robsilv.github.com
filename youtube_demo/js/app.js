!function(e,r,t){r.module("app",["templates","app.search","app.common","app.components","ui.router","angular-loading-bar"]).constant("config",{site:{},api:{root:"https://www.googleapis.com/youtube/v3",search:"/search",key:"API_KEY",config:{}}}).config(["$stateProvider","$urlRouterProvider","$locationProvider","cfpLoadingBarProvider",function(e,r,t,a){a.includeSpinner=!1,e.state("search",{url:"/search/{apiKey}/{query}",controller:"SearchController",templateUrl:"search/search-template.html",data:{pageTitle:"YouTube Search"}}),r.otherwise("/search/put_api_key_here/hello"),t.hashPrefix("!")}]).run(["$rootScope",function(){}]),r.module("app.search",[]),r.module("app.common",[]),r.module("app.components",[]),r.module("app").controller("AppController",["$scope","$location","MessageService",function(e,t,a){e.$on("$stateChangeSuccess",function(t,a){r.isDefined(a.data.pageTitle)&&(e.pageTitle=a.data.pageTitle)}),e.messages=a.messages}]),r.module("app.search").controller("SearchController",["$scope","$location","$state","$stateParams","$log","config","YouTubeService",function(e,r,a,o,s,n,c){e.search=function(r){s.log('Search "'+r+'"'),c.search(r).then(function(r){s.log("Search success",r),e.items=r.items})},e.setState=function(){o.query=e.searchQuery,s.log("SET STATE ",o),a.transitionTo(a.current,o,{reload:!0})},o.apiKey!==t&&(n.api.key=o.apiKey,s.log("SET API KEY "+n.api.key)),o.query!==t&&""!==o.query&&(s.log("SET QUERY "+o.query),e.searchQuery=o.query,e.search(e.searchQuery))}]),r.module("app.components").directive("messages",function(){return{restrict:"EA",scope:{messagesData:"="},templateUrl:"common/components/messages-directive-template.html",link:function(e){e.getMessageStyle=function(e){return"error"===e?"bg-danger":"success"===e?"bg-success":null},e.getMessage=function(e){var r=e.response.data.error.message;return r}}}}),r.module("app.common").factory("YouTubeService",["$q","$http","$log","config","Utils",function(e,r,t,a,o){function s(){}var n=a.api.root,c=a.api.config,u=new s;return u.search=function(e){a.funcName=o.getFunctionName(this,arguments),t.log("YouTubeService - search...");var s=n+a.api.search;s+="?part=snippet&q="+e+"&key="+a.api.key;var u=r.get(s,c).then(function(e){return t.log(" YouTubeService - Search results:",e),e.data});return u},u}]),r.module("app.common").factory("HttpInterceptor",["$q","$log","MessageService",function(e,r,t){var a={};return a.request=function(e){return e},a.requestError=function(a){return r.error("HttpInterceptor - requestError - rejection:"),r.log(a),t.addServiceErrorMessage(a),e.reject(a)},a.response=function(a){return"null"===a.data?(r.error("HttpInterceptor - response - error:"),r.log(a),t.addServiceErrorMessage(a),e.reject("Service failed to return data")):"OK"===a.data.status?a:"ERROR"===a.data.status?(r.error("HttpInterceptor - response - error:"),r.log(a),t.addServiceErrorMessage(a),e.reject(a.data.error.message)):a},a.responseError=function(a){return r.error("HttpInterceptor - responseError - rejection:"),r.log(a),t.addServiceErrorMessage(a,!0),e.reject(a)},a}]).config(["$httpProvider",function(e){e.interceptors.push("HttpInterceptor")}]),r.module("app.common").factory("MessageService",["$log",function(e){function r(){}var a=new r;return a.messages=[],a.messageTypes={},a.messageTypes.ERROR="error",a.messageTypes.SUCCESS="success",a.addServiceErrorMessage=function(r,o){var s={};s.response=r,s.messageType=a.messageTypes.ERROR;var n="A bad thing happened.",c=n;r.data.message&&""!==r.data.message&&(c=r.data.message),200!==r.status&&r.statusText&&""!==r.statusText&&(c+=" - "+r.status+" : "+r.statusText);var u;r.config!==t&&(r.config.funcName!==t?u=r.config.funcName:r.config.data!==t&&r.config.data.funcName!==t&&(u=r.config.data.funcName)),o&&c===n&&(c="API call rejected."),u!==t&&(s.message=u+" : "+c),e.log("Error message:",s),a.messages.push(s)},a.addSuccessMessage=function(e){var r={};r.message=e,r.messageType=a.messageTypes.SUCCESS,a.messages.push(r)},a}]),r.module("app.common").factory("Utils",function(){var e={};return e.isUndefinedOrNull=function(e){return!r.isDefined(e)||null===e},e.getFunctionName=function(e,r){var t=r.callee.name;return""===t&&(t="anonymousFunc"),e.constructor.name+"."+t},e})}(window,window.angular);